% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subcluster_anno.R
\name{anno_subcluster_inherit}
\alias{anno_subcluster_inherit}
\title{Run Marker-Inheritance Subcluster Annotation Workflow}
\usage{
anno_subcluster_inherit(
  sub_seurat,
  parent_marker_file,
  subcluster_res = "subcluster_res.0.1",
  original_cluster_col = "cluster_res.0.1",
  celltype_col = "celltype_res.0.1",
  top_n = 10,
  model = "gpt-4o",
  tissue_name = "Your tissue name",
  n_runs = 1,
  marker_dir = "output/subclusters",
  ontology_graph = NULL,
  ontology = NULL,
  save_dir = NULL,
  save_plots = TRUE,
  save_objects = FALSE
)
}
\arguments{
\item{sub_seurat}{Subcluster Seurat object.}

\item{parent_marker_file}{Path to parent cluster marker file.}

\item{subcluster_res}{Metadata column for subcluster assignment.}

\item{original_cluster_col}{Metadata column for parent cluster assignment.}

\item{celltype_col}{Metadata column for parent cell type annotation.}

\item{top_n}{Number of top markers per source (default: 10).}

\item{model}{Character. GPT model (default: 'gpt-4o').}

\item{tissue_name}{Character. Tissue context.}

\item{n_runs}{Number of GPT calls.}

\item{marker_dir}{Directory with subcluster markers.}

\item{ontology_graph}{igraph object (optional).}

\item{ontology}{ontologyIndex object (optional).}

\item{save_dir}{Directory for outputs (optional).}

\item{save_plots}{Whether to save plots.}

\item{save_objects}{Whether to save annotated objects.}
}
\value{
List with \code{summary} (annotation summary) and \code{seurat} (annotated Seurat).
}
\description{
For each subcluster, combines top marker genes from parent and subcluster, runs GPT annotation, and returns results.
}
